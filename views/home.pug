doctype html
html(lang=en)
    head
        meta(charset="UTF-8")
        meta(
            name="viewport"
            content="width=device-width, initial-scale=1.0")
        meta(
            http-equiv="X-UA-Compatible"
            content="ie=edge"
            )
        meta(
            name="description" 
            content="So I was securing my database against injection and suddenly had a signup page.  And since the original query given was to list everyone in the database, that got its own page too."
            )
        link(
            rel="stylesheet" 
            href="https://www.w3schools.com/w3css/4/w3.css")
        title Much more secure SQL (and some extra stuff)
    body
    header(class="w3-center w3-container w3-blue w3-card-4 w3-margin-bottom")
        h1(class="w3-padding-16") Register on our secure server (lol)!
    main(class="w3-center")
        div#container(class="w3-display-container w3-margin-top w3-padding")
            div#form(class="w3-mobile w3-display-topmiddle w3-half w3-card-4 w3-margin-top")
                if error
                    ul(class="w3-container w3-red w3-ul")
                        li 
                            h3 Welp, we've got some things to fix.
                        each err in error
                            li #{err.msg}
                else if success
                    ul(class="w3-container w3-green w3-ul")
                        li 
                            h3 Welcome to the party, #{name}!
                        li We'll refer to you as #{username} from now on.
                        li You'll get emails at #{email}.
                form(
                    method="POST" 
                    action="/register"
                    class="w3-padding"
                    )
                    p(class="w3-padding-bottom")
                        label(for="name") Name: 
                        input(
                            id="name"
                            name="name"
                            type="text"
                            minlength="2"
                            maxlength="50"
                            pattern="[^-']([a-zA-ZÀ-ÖØ-öø-ÿ '-](?!.*''|--|  |- |' | '| -.*))+" 
                            title="Please enter a valid name.  It may be 2-50 characters long.  You may use letters, spaces, hyphens, and apostrophes."
                            required="required"
                            class="w3-input w3-border"
                            value=(error ? name : false)
                            )
                    p(class="w3-padding-bottom")
                        label(for="username") Username: 
                        input(
                            id="username"
                            name="username"
                            type="text"
                            minlength="5"
                            maxlength="25"
                            pattern="([0-9a-zA-ZÀ-ÖØ-öø-ÿ'-_](?!.*''|--|__.*))+" 
                            title="Please enter a valid username with no spaces.  It may be 5-25 characters long.  You may use letters, numbers, hyphens, underscores, and apostrophes."
                            required="required"
                            class="w3-input w3-border"
                            value=(error ? username : false)
                            )
                    p(class="w3-padding-bottom")
                        label(for="email") Email: 
                        input(
                            id="email"
                            name="email"
                            type="email"
                            minlength="5"
                            maxlength="50"
                            title="Please enter a valid email address. It may be 5-50 characters long."
                            required="required"
                            class="w3-input w3-border"
                            value=(error ? email : false)
                            )
                        button(type="submit" class="w3-margin w3-padding w3-blue w3-button") Let's go!